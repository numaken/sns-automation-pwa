<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ±ºæ¸ˆå®Œäº† - SNSè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      background: white;
      border-radius: 16px;
      padding: 40px;
      text-align: center;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      margin: 20px;
    }

    .success-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .title {
      font-size: 28px;
      font-weight: bold;
      color: #1f2937;
      margin-bottom: 16px;
    }

    .subtitle {
      font-size: 16px;
      color: #6b7280;
      margin-bottom: 32px;
      line-height: 1.6;
    }

    .premium-badge {
      display: inline-flex;
      align-items: center;
      background: linear-gradient(45deg, #fbbf24, #f59e0b);
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      font-weight: bold;
      margin-bottom: 24px;
      font-size: 18px;
    }

    .crown {
      margin-right: 8px;
    }

    .feature-list {
      text-align: left;
      background: #f8fafc;
      border-radius: 12px;
      padding: 24px;
      margin: 24px 0;
    }

    .feature-item {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      color: #374151;
    }

    .feature-item:last-child {
      margin-bottom: 0;
    }

    .check {
      color: #10b981;
      margin-right: 12px;
      font-weight: bold;
    }

    .button {
      background: linear-gradient(45deg, #3b82f6, #1d4ed8);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.4);
    }

    .session-info {
      background: #f3f4f6;
      border-radius: 8px;
      padding: 16px;
      margin: 20px 0;
      font-family: monospace;
      font-size: 14px;
      color: #6b7280;
    }

    .loading {
      display: none;
      color: #6b7280;
      margin: 20px 0;
    }

    .error {
      display: none;
      background: #fef2f2;
      border: 1px solid #fecaca;
      color: #dc2626;
      padding: 16px;
      border-radius: 8px;
      margin: 20px 0;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="success-icon">ğŸ‰</div>
    <h1 class="title">æ±ºæ¸ˆãŒå®Œäº†ã—ã¾ã—ãŸï¼</h1>
    <p class="subtitle">
      SNSè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ« ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã¸ã‚ˆã†ã“ãï¼<br>
      ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
    </p>

    <div class="premium-badge">
      <span class="crown">ğŸ‘‘</span>
      PREMIUM MEMBER
    </div>

    <div class="feature-list">
      <div class="feature-item">
        <span class="check">âœ…</span>
        ç„¡åˆ¶é™AIæŠ•ç¨¿ç”Ÿæˆ
      </div>
      <div class="feature-item">
        <span class="check">âœ…</span>
        Twitter/Threadsè‡ªå‹•æŠ•ç¨¿
      </div>
      <div class="feature-item">
        <span class="check">âœ…</span>
        é«˜é€Ÿç”Ÿæˆï¼ˆå°‚ç”¨APIã‚­ãƒ¼ï¼‰
      </div>
      <div class="feature-item">
        <span class="check">âœ…</span>
        åºƒå‘Šãªã—ã®ã‚¯ãƒªãƒ¼ãƒ³UI
      </div>
      <div class="feature-item">
        <span class="check">âœ…</span>
        å„ªå…ˆã‚µãƒãƒ¼ãƒˆ
      </div>
    </div>

    <div id="sessionInfo" class="session-info" style="display: none;">
      ã‚»ãƒƒã‚·ãƒ§ãƒ³ID: <span id="sessionId">å–å¾—ä¸­...</span>
    </div>

    <div id="loading" class="loading">
      ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã«ç§»è¡Œä¸­... â³
    </div>

    <div id="error" class="error">
      è‡ªå‹•ç§»è¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ç§»è¡Œã‚’å®Œäº†ã—ã¦ãã ã•ã„ã€‚
    </div>

    <a href="/" class="button" id="returnButton">
      ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨é–‹å§‹
    </a>
  </div>

  <script>
    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’å–å¾—
    const urlParams = new URLSearchParams(window.location.search);
    const sessionId = urlParams.get('session_id');

    if (sessionId) {
      document.getElementById('sessionInfo').style.display = 'block';
      document.getElementById('sessionId').textContent = sessionId;

      // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã«è‡ªå‹•ç§»è¡Œ
      document.getElementById('loading').style.display = 'block';

      try {
        // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³æƒ…å ±ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
        localStorage.setItem('userPlan', 'premium');
        localStorage.setItem('subscriptionStatus', 'active');
        localStorage.setItem('stripeSessionId', sessionId);
        localStorage.setItem('premiumActivatedAt', new Date().toISOString());

        // ç„¡æ–™ãƒ—ãƒ©ãƒ³ã®ä½¿ç”¨é‡åˆ¶é™ã‚’ã‚¯ãƒªã‚¢
        localStorage.removeItem('dailyUsage');

        console.log('âœ… ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã«è‡ªå‹•ç§»è¡Œå®Œäº†');
        console.log('ã‚»ãƒƒã‚·ãƒ§ãƒ³ID:', sessionId);

        setTimeout(() => {
          document.getElementById('loading').style.display = 'none';

          // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°
          document.querySelector('.subtitle').innerHTML =
            'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã¸ã®ç§»è¡ŒãŒå®Œäº†ã—ã¾ã—ãŸï¼<br>ç„¡åˆ¶é™ã§SNSè‡ªå‹•åŒ–ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚';

          // ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
          document.getElementById('returnButton').textContent = 'âœ¨ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã‚’ä½¿ã†';
        }, 2000);

      } catch (error) {
        console.error('âŒ è‡ªå‹•ç§»è¡Œã‚¨ãƒ©ãƒ¼:', error);
        document.getElementById('loading').style.display = 'none';
        document.getElementById('error').style.display = 'block';

        // æ‰‹å‹•ç§»è¡Œã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
        document.getElementById('error').innerHTML = `
                    è‡ªå‹•ç§»è¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼ˆF12ï¼‰ã§å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š<br><br>
                    <code style="background: #f3f4f6; padding: 8px; border-radius: 4px; display: block; margin: 8px 0;">
                        localStorage.setItem('userPlan', 'premium');<br>
                        localStorage.setItem('subscriptionStatus', 'active');<br>
                        localStorage.setItem('stripeSessionId', '${sessionId}');<br>
                        window.location.href = '/';
                    </code>
                `;
      }
    } else {
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
      document.querySelector('.subtitle').innerHTML =
        'ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ãŒã€æ±ºæ¸ˆã¯å®Œäº†ã—ã¦ã„ã¾ã™ã€‚<br>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚';
    }

    // ãƒ‡ãƒãƒƒã‚°æƒ…å ±
    console.log('ğŸ” æ±ºæ¸ˆæˆåŠŸãƒšãƒ¼ã‚¸æƒ…å ±:', {
      sessionId: sessionId,
      currentPlan: localStorage.getItem('userPlan'),
      subscriptionStatus: localStorage.getItem('subscriptionStatus'),
      timestamp: new Date().toISOString()
    });
  </script>
</body>

</html>